<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Study ZONE | Enrolment Request</title>

<style>
body{
  margin:0;
  font-family:Segoe UI,Arial,sans-serif;
  background:#eef3ff;
  color:#003366;
}
.container{
  max-width:720px;
  margin:15px auto;
  background:#fff;
  padding:18px 22px;
  border-radius:8px;
  box-shadow:0 6px 16px rgba(0,0,0,.1);
}
h1{text-align:center;color:#004aad;font-size:22px}
label{margin-top:10px;display:block;font-weight:600;font-size:13px}
input,select,textarea{
  width:100%;padding:8px;margin-top:4px;
  border-radius:5px;border:1px solid #ccc;font-size:13px
}
input[readonly]{background:#f2f4f8}
button{
  width:100%;margin-top:18px;padding:10px;
  background:#004aad;color:#fff;border:none;
  border-radius:6px;font-size:15px;cursor:pointer
}
</style>
</head>

<body>
<div class="container">
<h1>Enrolment Request</h1>

<form id="enrollForm">

<label>Member Type *</label>
<select id="memberType" name="Member Type" required>
  <option value="">Select</option>
  <option>First Time</option>
  <option>Existing Member</option>
</select>

<div id="formFields" style="display:none">

<label>Full Name *</label>
<input type="text" name="Full Name" required>

<label>Mobile Number *</label>
<input type="tel" name="Mobile Number" pattern="[0-9]{10}" maxlength="10" required>

<label>Email ID</label>
<input type="email" name="Email ID">

<div id="firstTimeOnly">
<label>Address *</label>
<textarea name="Address"></textarea>

<label>City *</label>
<input type="text" name="City">
</div>

<label>Exam Preparing for *</label>
<input type="text" name="Exam Preparing for" required>

<label>Preferred Branch *</label>
<select id="branch" name="Preferred Branch" required>
  <option value="">Select</option>
  <option>Dombivli East (MIDC)</option>
  <option>Dombivli West</option>
</select>

<label>Preferred Plan *</label>
<select id="plan" name="Preferred Plan" required>
  <option value="">Select</option>
  <option>Max Plan – Full Day</option>
  <option>Light Plan – Morning Slot</option>
  <option>Light Plan – Afternoon Slot</option>
  <option>Light Plan – Evening Slot</option>
  <option>Light flexi Plan - Morning + Afternoon Slot</option>
  <option>Light flexi Plan - Morning + Evening Slot</option>
  <option>Light flexi Plan - Afternoon + Evening Slot</option>
  <option>Weekend - Only Saturday & Sunday</option>
  <option>Mini Plan - Morning Slot</option>
  <option>Mini Plan - Evening Slot</option>
  <option>Single Day Plan - Full Day</option>
</select>

<label>Start Date *</label>
<input type="date" id="startDate" name="Start Date" required>

<label>No. of Days to Book *</label>
<input type="number" id="days" name="No. of Days to Book" min="1" required>

<label>End Date</label>
<input type="date" id="endDateDisplay" readonly>

<label>Estimated Cost (₹)</label>
<input type="number" id="estimatedCostDisplay" readonly>

<label>Registration Fees (₹)</label>
<input type="number" id="registrationFeesDisplay" readonly>

<label>Grand Estimated Cost (₹)</label>
<input type="number" id="grandCostDisplay" readonly>

<!-- HIDDEN – EXACT HEADER MATCH -->
<input type="hidden" name="Unit Price">
<input type="hidden" name="End Date">
<input type="hidden" name="Estimated Cost">
<input type="hidden" name="Registration Fees">
<input type="hidden" name="Grand Estimated Cost">

<label>Any specific requirement or message</label>
<textarea name="Any specific requirement or message"></textarea>

<button type="submit">Submit Subscription Request</button>
</div>
</form>
</div>

<script>
const pricing={
"Dombivli East (MIDC)|Max Plan – Full Day":94,
"Dombivli East (MIDC)|Light Plan – Morning Slot":54,
"Dombivli East (MIDC)|Light Plan – Afternoon Slot":54,
"Dombivli East (MIDC)|Light Plan – Evening Slot":54,
"Dombivli East (MIDC)|Light flexi Plan - Morning + Afternoon Slot":74,
"Dombivli East (MIDC)|Light flexi Plan - Morning + Evening Slot":74,
"Dombivli East (MIDC)|Light flexi Plan - Afternoon + Evening Slot":74,
"Dombivli East (MIDC)|Weekend - Only Saturday & Sunday":66.7,
"Dombivli East (MIDC)|Mini Plan - Morning Slot":40,
"Dombivli East (MIDC)|Mini Plan - Evening Slot":40,
"Dombivli East (MIDC)|Single Day Plan - Full Day":250,

"Dombivli West|Max Plan – Full Day":60,
"Dombivli West|Light Plan – Morning Slot":40,
"Dombivli West|Light Plan – Afternoon Slot":40,
"Dombivli West|Light Plan – Evening Slot":40,
"Dombivli West|Light flexi Plan - Morning + Afternoon Slot":50,
"Dombivli West|Light flexi Plan - Morning + Evening Slot":50,
"Dombivli West|Light flexi Plan - Afternoon + Evening Slot":50,
"Dombivli West|Weekend - Only Saturday & Sunday":42.7,
"Dombivli West|Mini Plan - Morning Slot":25,
"Dombivli West|Mini Plan - Evening Slot":25,
"Dombivli West|Single Day Plan - Full Day":150
};

const memberType=document.getElementById("memberType");
const formFields=document.getElementById("formFields");
const firstTimeOnly=document.getElementById("firstTimeOnly");

memberType.onchange=()=>{
  formFields.style.display=memberType.value?"block":"none";
  firstTimeOnly.style.display=memberType.value==="First Time"?"block":"none";
};

startDate.min=new Date().toISOString().split("T")[0];

["branch","plan","days","startDate","memberType"].forEach(id=>{
 document.getElementById(id).addEventListener("change",calculate);
});

function calculate(){
 if(!branch.value||!plan.value||!days.value||!startDate.value)return;

 const d=+days.value;
 if(plan.value.includes("Weekend") && d%30!==0){
   alert("Weekend plan allows booking only in multiples of 30 days");
   days.value="";return;
 }
 if(!plan.value.includes("Weekend") && !plan.value.includes("Single Day") && d<8){
   alert("Minimum 8 days booking required");
   days.value="";return;
 }

 const price=pricing[`${branch.value}|${plan.value}`];
 const s=new Date(startDate.value);
 const e=new Date(s); e.setDate(s.getDate()+d-1);

 const est=price*d;
 const reg=memberType.value==="First Time"?175:0;

 endDateDisplay.value=e.toISOString().split("T")[0];
 estimatedCostDisplay.value=est;
 registrationFeesDisplay.value=reg;
 grandCostDisplay.value=est+reg;

 enrollForm["Unit Price"].value=price;
 enrollForm["End Date"].value=endDateDisplay.value;
 enrollForm["Estimated Cost"].value=est;
 enrollForm["Registration Fees"].value=reg;
 enrollForm["Grand Estimated Cost"].value=est+reg;
}

enrollForm.addEventListener("submit",e=>{
 e.preventDefault();
 fetch("https://script.google.com/macros/s/AKfycbwF_8R8AKgr2MApLGvStZBlobgcBhVaF2k8K2egOZBCBDPLN5--cPNP4poQ7LiUUGy6sg/exec",
 {method:"POST",body:new FormData(enrollForm)})
 .then(r=>r.json())
 .then(()=>alert("Enrolment submitted successfully"));
});
</script>
</body>
</html>
