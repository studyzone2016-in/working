<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Study ZONE | Enrolment Request</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Segoe UI, Arial, sans-serif;
  background:#eef3ff;
  margin:0;
}
.container{
  max-width:720px;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:8px;
}
label{
  font-weight:600;
  font-size:13px;
  margin-top:12px;
  display:block;
}
input, select, textarea{
  width:100%;
  padding:8px;
  margin-top:4px;
}
input[readonly]{
  background:#f3f5f8;
}
.error{
  color:#d60000;
  font-size:12px;
}
.helper{
  font-size:11px;
  color:#666;
}
button{
  margin-top:18px;
  padding:12px;
  width:100%;
  background:#004aad;
  color:#fff;
  border:none;
  cursor:pointer;
}
.success-box{
  text-align:center;
  padding:40px 20px;
}
.success-box h2{
  color:#1a7f37;
}
.success-box a{
  display:inline-block;
  margin-top:20px;
  text-decoration:none;
  color:#004aad;
  font-weight:600;
}
</style>
</head>

<body>
<div class="container">

<h2 id="formTitle">Enrolment Request</h2>

<form id="enrollForm">

<label>Member Type *</label>
<select id="memberType" name="Member Type" required>
  <option value="">Select</option>
  <option>First Time</option>
  <option>Existing Member</option>
</select>

<div id="mainFields" style="display:none">

<label>Full Name *</label>
<input name="Full Name" required>

<label>Mobile Number *</label>
<input id="mobile" name="Mobile Number" maxlength="10" required placeholder="10 digit mobile number">
<div id="mobileError" class="error"></div>

<label>Email ID</label>
<input type="email" name="Email ID" placeholder="example@email.com">

<label>Address *</label>
<textarea name="Address" required></textarea>

<label>City *</label>
<input name="City" required>

<label>Exam Preparing for *</label>
<input name="Exam Preparing for" required placeholder="NEET, UPSC, CA, JEE, Banking, SSC, HSC...">

<label>Preferred Branch *</label>
<select id="branch" name="Preferred Branch" required>
  <option value="">Select</option>
  <option>Dombivli East (MIDC)</option>
  <option>Dombivli West</option>
</select>

<label>Preferred Plan *</label>
<select id="plan" name="Preferred Plan" required>
  <option value="">Select</option>
  <option>Max Plan – Full Day</option>
  <option>Light Plan – Morning Slot</option>
  <option>Light Plan – Afternoon Slot</option>
  <option>Light Plan – Evening Slot</option>
  <option>Light flexi Plan - Morning + Afternoon Slot</option>
  <option>Light flexi Plan - Morning + Evening Slot</option>
  <option>Light flexi Plan - Afternoon + Evening Slot</option>
  <option>Weekend - Only Saturday & Sunday</option>
  <option>Mini Plan - Morning Slot</option>
  <option>Mini Plan - Evening Slot</option>
  <option>Single Day Plan - Full Day</option>
</select>

<label>Any specific requirement or message</label>
<textarea name="Any specific requirement or message"></textarea>

<label>Start Date *</label>
<input type="date" id="startDate" name="Start Date" required>
<div class="helper">Ex: 22 Jan 2026</div>

<label>No. of Days to Book *</label>
<input type="number" id="days" name="No. of Days to Book" required>
<div id="daysError" class="error"></div>

<label>End Date</label>
<input id="endDateView" readonly>

<label>Estimated Cost (₹)</label>
<input id="estView" readonly>

<label>Registration Fees (₹)</label>
<input id="regView" readonly>

<label>Grand Estimated Cost (₹)</label>
<input id="grandView" readonly>

<input type="hidden" name="Unit Price">
<input type="hidden" name="End Date">
<input type="hidden" name="Estimated Cost">
<input type="hidden" name="Registration Fees">
<input type="hidden" name="Grand Estimated Cost">

<button type="submit">Submit Subscription Request</button>
</div>
</form>

<div id="successBox" class="success-box" style="display:none">
  <h2>✅ Thank you!</h2>
  <p>Your enrolment request has been received.<br>
     Our team will contact you shortly.</p>
  <a href="/">Go to Home Page</a>
</div>

</div>

<script>
const memberType = document.getElementById("memberType");
const mainFields = document.getElementById("mainFields");
const mobile = document.getElementById("mobile");
const mobileError = document.getElementById("mobileError");
const branch = document.getElementById("branch");
const plan = document.getElementById("plan");
const startDate = document.getElementById("startDate");
const days = document.getElementById("days");
const daysError = document.getElementById("daysError");
const form = document.getElementById("enrollForm");

startDate.min = new Date().toISOString().split("T")[0];

function formatDate(d){
  return d.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"});
}

mobile.addEventListener("input", () => {
  mobile.value = mobile.value.replace(/\D/g,'');
  mobileError.textContent =
    mobile.value.length !== 10 ? "Mobile number must be exactly 10 digits" : "";
});

memberType.addEventListener("change", () => {
  mainFields.style.display = memberType.value ? "block" : "none";
});

[branch, plan, startDate, days].forEach(el =>
  el.addEventListener("change", calculate)
);

function calculate(){
  daysError.textContent = "";
  if(!branch.value || !plan.value || !days.value || !startDate.value) return;

  const d = Number(days.value);

  // ✅ DAY RULES
  if(plan.value === "Single Day Plan - Full Day" && d !== 1){
    daysError.textContent = "Single Day Plan allows only 1 day booking";
    return;
  }

  if(plan.value === "Weekend - Only Saturday & Sunday"){
    if(d % 30 !== 0){
      daysError.textContent = "Weekend plan allows only multiples of 30 days (30, 60, 90...)";
      return;
    }
  } else if(d < 8){
    daysError.textContent = "Minimum booking is 8 days";
    return;
  }

  const pricing = {
    "Dombivli East (MIDC)|Max Plan – Full Day":94,
    "Dombivli East (MIDC)|Light Plan – Morning Slot":54,
    "Dombivli East (MIDC)|Light Plan – Afternoon Slot":54,
    "Dombivli East (MIDC)|Light Plan – Evening Slot":54,
    "Dombivli East (MIDC)|Light flexi Plan - Morning + Afternoon Slot":74,
    "Dombivli East (MIDC)|Light flexi Plan - Morning + Evening Slot":74,
    "Dombivli East (MIDC)|Light flexi Plan - Afternoon + Evening Slot":74,
    "Dombivli East (MIDC)|Weekend - Only Saturday & Sunday":66.7,
    "Dombivli East (MIDC)|Mini Plan - Morning Slot":40,
    "Dombivli East (MIDC)|Mini Plan - Evening Slot":40,
    "Dombivli East (MIDC)|Single Day Plan - Full Day":250,
    "Dombivli West|Max Plan – Full Day":60,
    "Dombivli West|Light Plan – Morning Slot":40,
    "Dombivli West|Light Plan – Afternoon Slot":40,
    "Dombivli West|Light Plan – Evening Slot":40,
    "Dombivli West|Light flexi Plan - Morning + Afternoon Slot":50,
    "Dombivli West|Light flexi Plan - Morning + Evening Slot":50,
    "Dombivli West|Light flexi Plan - Afternoon + Evening Slot":50,
    "Dombivli West|Weekend - Only Saturday & Sunday":42.7,
    "Dombivli West|Mini Plan - Morning Slot":25,
    "Dombivli West|Mini Plan - Evening Slot":25,
    "Dombivli West|Single Day Plan - Full Day":150
  };

  const unit = pricing[`${branch.value}|${plan.value}`];
  const s = new Date(startDate.value);
  const e = new Date(s);
  e.setDate(s.getDate() + d - 1);

  const est = unit * d;
  const reg = memberType.value === "First Time" ? 175 : 0;
  const grand = est + reg;

  endDateView.value = formatDate(e);
  estView.value = est;
  regView.value = reg;
  grandView.value = grand;

  form["Unit Price"].value = unit;
  form["End Date"].value = e.toISOString().split("T")[0];
  form["Estimated Cost"].value = est;
  form["Registration Fees"].value = reg;
  form["Grand Estimated Cost"].value = grand;
}

form.addEventListener("submit", e => {
  e.preventDefault();
  if(mobile.value.length !== 10 || daysError.textContent) return;

  fetch("https://script.google.com/macros/s/AKfycby-stYcFCHWOJWPebMMMnkwPCuw08XJY1CffLiK5P-Octo840UnEK1xJmePS0K6ln1bKA/exec", {
    method:"POST",
    body:new FormData(form)
  })
  .then(()=> {
    form.style.display="none";
    formTitle.style.display="none";
    successBox.style.display="block";
  });
});
</script>

</body>
</html>
