<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Study ZONE | Enrolment Request</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Segoe UI, Arial, sans-serif;
  background:#eef3ff;
  margin:0;
}
.container{
  max-width:720px;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:8px;
}
label{
  font-weight:600;
  font-size:13px;
  margin-top:12px;
  display:block;
}
input, select, textarea{
  width:100%;
  padding:8px;
  margin-top:4px;
}
input[readonly]{
  background:#f3f5f8;
}
button{
  margin-top:18px;
  padding:12px;
  width:100%;
  background:#004aad;
  color:#fff;
  border:none;
  cursor:pointer;
}
</style>
</head>

<body>
<div class="container">
<h2>Enrolment Request</h2>

<form id="enrollForm">

<!-- MEMBER TYPE -->
<label>Member Type *</label>
<select id="memberType" name="Member Type" required>
  <option value="">Select</option>
  <option>First Time</option>
  <option>Existing Member</option>
</select>

<div id="mainFields" style="display:none">

<label>Full Name *</label>
<input name="Full Name" required>

<label>Mobile Number *</label>
<input name="Mobile Number" pattern="[0-9]{10}" maxlength="10" required>

<label>Email ID</label>
<input type="email" name="Email ID">

<label>Address *</label>
<textarea name="Address" required></textarea>

<label>City *</label>
<input name="City" required>

<label>Exam Preparing for *</label>
<input name="Exam Preparing for" required>

<label>Preferred Branch *</label>
<select id="branch" name="Preferred Branch" required>
  <option value="">Select</option>
  <option>Dombivli East (MIDC)</option>
  <option>Dombivli West</option>
</select>

<label>Preferred Plan *</label>
<select id="plan" name="Preferred Plan" required>
  <option value="">Select</option>
  <option>Max Plan – Full Day</option>
  <option>Light Plan – Morning Slot</option>
  <option>Light Plan – Afternoon Slot</option>
  <option>Light Plan – Evening Slot</option>
  <option>Light flexi Plan - Morning + Afternoon Slot</option>
  <option>Light flexi Plan - Morning + Evening Slot</option>
  <option>Light flexi Plan - Afternoon + Evening Slot</option>
  <option>Weekend - Only Saturday & Sunday</option>
  <option>Mini Plan - Morning Slot</option>
  <option>Mini Plan - Evening Slot</option>
  <option>Single Day Plan - Full Day</option>
</select>

<label>Any specific requirement or message</label>
<textarea name="Any specific requirement or message"></textarea>

<label>Start Date *</label>
<input type="date" id="startDate" name="Start Date" required>

<label>No. of Days to Book *</label>
<input type="number" id="days" name="No. of Days to Book" required>

<label>End Date</label>
<input id="endDateView" readonly>

<label>Estimated Cost (₹)</label>
<input id="estView" readonly>

<label>Registration Fees (₹)</label>
<input id="regView" readonly>

<label>Grand Estimated Cost (₹)</label>
<input id="grandView" readonly>

<!-- HIDDEN FIELDS → WRITE TO SHEET -->
<input type="hidden" name="Unit Price">
<input type="hidden" name="End Date">
<input type="hidden" name="Estimated Cost">
<input type="hidden" name="Registration Fees">
<input type="hidden" name="Grand Estimated Cost">

<button type="submit">Submit Enrolment</button>

</div>
</form>
</div>

<script>
const pricing = {
  "Dombivli East (MIDC)|Max Plan – Full Day":94,
  "Dombivli East (MIDC)|Light Plan – Morning Slot":54,
  "Dombivli East (MIDC)|Light Plan – Afternoon Slot":54,
  "Dombivli East (MIDC)|Light Plan – Evening Slot":54,
  "Dombivli East (MIDC)|Light flexi Plan - Morning + Afternoon Slot":74,
  "Dombivli East (MIDC)|Light flexi Plan - Morning + Evening Slot":74,
  "Dombivli East (MIDC)|Light flexi Plan - Afternoon + Evening Slot":74,
  "Dombivli East (MIDC)|Weekend - Only Saturday & Sunday":66.7,
  "Dombivli East (MIDC)|Mini Plan - Morning Slot":40,
  "Dombivli East (MIDC)|Mini Plan - Evening Slot":40,
  "Dombivli East (MIDC)|Single Day Plan - Full Day":250,

  "Dombivli West|Max Plan – Full Day":60,
  "Dombivli West|Light Plan – Morning Slot":40,
  "Dombivli West|Light Plan – Afternoon Slot":40,
  "Dombivli West|Light Plan – Evening Slot":40,
  "Dombivli West|Light flexi Plan - Morning + Afternoon Slot":50,
  "Dombivli West|Light flexi Plan - Morning + Evening Slot":50,
  "Dombivli West|Light flexi Plan - Afternoon + Evening Slot":50,
  "Dombivli West|Weekend - Only Saturday & Sunday":42.7,
  "Dombivli West|Mini Plan - Morning Slot":25,
  "Dombivli West|Mini Plan - Evening Slot":25,
  "Dombivli West|Single Day Plan - Full Day":150
};

const form = document.getElementById("enrollForm");
const fields = document.getElementById("mainFields");

memberType.onchange = () => {
  fields.style.display = memberType.value ? "block" : "none";
  calculate();
};

startDate.min = new Date().toISOString().split("T")[0];
["branch","plan","days","startDate","memberType"].forEach(id=>{
  document.getElementById(id).onchange = calculate;
});

function calculate(){
  if(!branch.value || !plan.value || !days.value || !startDate.value) return;

  const d = Number(days.value);
  const price = pricing[`${branch.value}|${plan.value}`];
  if(!price) return;

  if(plan.value.includes("Weekend") && d % 30 !== 0){
    alert("Weekend plans must be booked in multiples of 30 days");
    return;
  }
  if(!plan.value.includes("Weekend") && !plan.value.includes("Single Day") && d < 8){
    alert("Minimum booking is 8 days");
    return;
  }

  const start = new Date(startDate.value);
  const end = new Date(start);
  end.setDate(start.getDate() + d - 1);

  const est = price * d;
  const reg = memberType.value === "First Time" ? 175 : 0;
  const grand = est + reg;

  endDateView.value = end.toISOString().split("T")[0];
  estView.value = est;
  regView.value = reg;
  grandView.value = grand;

  form["Unit Price"].value = price;
  form["End Date"].value = endDateView.value;
  form["Estimated Cost"].value = est;
  form["Registration Fees"].value = reg;
  form["Grand Estimated Cost"].value = grand;
}

form.onsubmit = e => {
  e.preventDefault();

  fetch("https://script.google.com/macros/s/AKfycbx3XAPmWIpsgHSBpD1-im20jfrOomEn2NT9vk9iSLSvk7Lu9cB-KEtsjg1_PNEno0f6IA/exec", {
    method: "POST",
    body: new FormData(form)
  })
  .then(() => {
    alert("Enrolment submitted successfully");
    form.reset();
    fields.style.display = "none";
  });
};
</script>
</body>
</html>
