<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Study ZONE | Enrolment Request</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Segoe UI, Arial, sans-serif;
  background:#eef3ff;
  margin:0;
}
.container{
  max-width:720px;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:8px;
}
label{
  font-weight:600;
  font-size:13px;
  margin-top:12px;
  display:block;
}
input, select, textarea{
  width:100%;
  padding:8px;
  margin-top:4px;
}
input[readonly]{
  background:#f3f5f8;
}
button{
  margin-top:18px;
  padding:12px;
  width:100%;
  background:#004aad;
  color:#fff;
  border:none;
  cursor:pointer;
}
</style>
</head>

<body>
<div class="container">
<h2>Enrolment Request</h2>

<form id="enrollForm">

<label>Member Type *</label>
<select id="memberType" name="Member Type" required>
  <option value="">Select</option>
  <option>First Time</option>
  <option>Existing Member</option>
</select>

<div id="mainFields" style="display:none">

<label>Full Name *</label>
<input name="Full Name" required>

<label>Mobile Number *</label>
<input name="Mobile Number" maxlength="10" required>

<label>Email ID</label>
<input type="email" name="Email ID">

<!-- ADDRESS BLOCK -->
<div id="addressBlock">
  <label>Address *</label>
  <textarea name="Address"></textarea>
</div>

<!-- CITY BLOCK -->
<div id="cityBlock">
  <label>City *</label>
  <input name="City">
</div>

<label>Exam Preparing for *</label>
<input name="Exam Preparing for" required>

<label>Preferred Branch *</label>
<select id="branch" name="Preferred Branch" required>
  <option value="">Select</option>
  <option>Dombivli East (MIDC)</option>
  <option>Dombivli West</option>
</select>

<label>Preferred Plan *</label>
<select id="plan" name="Preferred Plan" required>
  <option value="">Select</option>
  <option>Max Plan – Full Day</option>
  <option>Light Plan – Morning Slot</option>
  <option>Light Plan – Afternoon Slot</option>
  <option>Light Plan – Evening Slot</option>
  <option>Light flexi Plan - Morning + Afternoon Slot</option>
  <option>Light flexi Plan - Morning + Evening Slot</option>
  <option>Light flexi Plan - Afternoon + Evening Slot</option>
  <option>Weekend - Only Saturday & Sunday</option>
  <option>Mini Plan - Morning Slot</option>
  <option>Mini Plan - Evening Slot</option>
  <option>Single Day Plan - Full Day</option>
</select>

<label>Any specific requirement or message</label>
<textarea name="Any specific requirement or message"></textarea>

<label>Start Date *</label>
<input type="date" id="startDate" name="Start Date" required>

<label>No. of Days to Book *</label>
<input type="number" id="days" name="No. of Days to Book" required>

<label>End Date</label>
<input id="endDateView" readonly>

<label>Estimated Cost (₹)</label>
<input id="estView" readonly>

<label>Registration Fees (₹)</label>
<input id="regView" readonly>

<label>Grand Estimated Cost (₹)</label>
<input id="grandView" readonly>

<!-- HIDDEN FOR SHEET -->
<input type="hidden" name="Unit Price">
<input type="hidden" name="End Date">
<input type="hidden" name="Estimated Cost">
<input type="hidden" name="Registration Fees">
<input type="hidden" name="Grand Estimated Cost">

<button type="submit">Submit Subscription Request</button>

</div>
</form>
</div>

<script>
const memberType = document.getElementById("memberType");
const mainFields = document.getElementById("mainFields");
const addressBlock = document.getElementById("addressBlock");
const cityBlock = document.getElementById("cityBlock");
const branch = document.getElementById("branch");
const plan = document.getElementById("plan");
const startDate = document.getElementById("startDate");
const days = document.getElementById("days");
const form = document.getElementById("enrollForm");

startDate.min = new Date().toISOString().split("T")[0];

const pricing = {
  "Dombivli East (MIDC)|Max Plan – Full Day":94,
  "Dombivli East (MIDC)|Light Plan – Morning Slot":54,
  "Dombivli East (MIDC)|Light Plan – Afternoon Slot":54,
  "Dombivli East (MIDC)|Light Plan – Evening Slot":54,
  "Dombivli East (MIDC)|Light flexi Plan - Morning + Afternoon Slot":74,
  "Dombivli East (MIDC)|Light flexi Plan - Morning + Evening Slot":74,
  "Dombivli East (MIDC)|Light flexi Plan - Afternoon + Evening Slot":74,
  "Dombivli East (MIDC)|Weekend - Only Saturday & Sunday":66.7,
  "Dombivli East (MIDC)|Mini Plan - Morning Slot":40,
  "Dombivli East (MIDC)|Mini Plan - Evening Slot":40,
  "Dombivli East (MIDC)|Single Day Plan - Full Day":250,

  "Dombivli West|Max Plan – Full Day":60,
  "Dombivli West|Light Plan – Morning Slot":40,
  "Dombivli West|Light Plan – Afternoon Slot":40,
  "Dombivli West|Light Plan – Evening Slot":40,
  "Dombivli West|Light flexi Plan - Morning + Afternoon Slot":50,
  "Dombivli West|Light flexi Plan - Morning + Evening Slot":50,
  "Dombivli West|Light flexi Plan - Afternoon + Evening Slot":50,
  "Dombivli West|Weekend - Only Saturday & Sunday":42.7,
  "Dombivli West|Mini Plan - Morning Slot":25,
  "Dombivli West|Mini Plan - Evening Slot":25,
  "Dombivli West|Single Day Plan - Full Day":150
};

memberType.addEventListener("change", () => {
  if(!memberType.value){
    mainFields.style.display = "none";
    return;
  }
  mainFields.style.display = "block";

  if(memberType.value === "Existing Member"){
    addressBlock.style.display = "none";
    cityBlock.style.display = "none";
  }else{
    addressBlock.style.display = "block";
    cityBlock.style.display = "block";
  }
  calculate();
});

[branch, plan, startDate, days].forEach(el =>
  el.addEventListener("change", calculate)
);

function calculate(){
  if(!branch.value || !plan.value || !days.value || !startDate.value) return;

  const d = Number(days.value);
  const unit = pricing[`${branch.value}|${plan.value}`];
  if(!unit) return;

  if(plan.value.includes("Weekend") && d % 30 !== 0){
    alert("Weekend plans must be booked in multiples of 30 days");
    return;
  }
  if(!plan.value.includes("Weekend") && !plan.value.includes("Single Day") && d < 8){
    alert("Minimum booking is 8 days");
    return;
  }

  const s = new Date(startDate.value);
  const e = new Date(s);
  e.setDate(s.getDate() + d - 1);

  const est = unit * d;
  const reg = memberType.value === "First Time" ? 175 : 0;
  const grand = est + reg;

  endDateView.value = e.toISOString().split("T")[0];
  estView.value = est;
  regView.value = reg;
  grandView.value = grand;

  form["Unit Price"].value = unit;
  form["End Date"].value = endDateView.value;
  form["Estimated Cost"].value = est;
  form["Registration Fees"].value = reg;
  form["Grand Estimated Cost"].value = grand;
}

form.addEventListener("submit", e => {
  e.preventDefault();

  fetch("https://script.google.com/macros/s/AKfycby-stYcFCHWOJWPebMMMnkwPCuw08XJY1CffLiK5P-Octo840UnEK1xJmePS0K6ln1bKA/exec", {
    method: "POST",
    body: new FormData(form)
  })
  .then(res => res.json())
  .then(() => {
    alert("Enrolment submitted successfully");
    form.reset();
    mainFields.style.display = "none";
  });
});
</script>

</body>
</html>
